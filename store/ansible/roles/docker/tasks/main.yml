---
- name: install docker requirements
  apt: 
    name: '{{ item }}' 
    state: latest 
    update_cache: yes
  loop: [ 'apt-transport-https', 'ca-certificates', 'curl', 'software-properties-common']

- name: add docker key
  apt_key:
    url: https://download.docker.com/linux/ubuntu/gpg
    state: present

- name: pull docker repo
  apt_repository:
    repo: deb https://download.docker.com/linux/ubuntu bionic stable
    state: present

- name: install docker-ce
  apt: 
    update_cache: yes 
    name: docker-ce 
    state: latest

- name: install docker-compose
  get_url:
    url: https://github.com/docker/compose/releases/download/1.29.2/docker-compose-Linux-x86_64
    dest: /usr/local/bin/docker-compose
    mode: 'u+x,g+x'

- name: permissions on docker-compose
  file: 
    dest: /usr/local/bin/docker-compose 
    mode: +x

- name: install python3-docker
  apt: 
    update_cache: yes 
    name: python3-docker
    state: latest

- name: install pip3
  apt: 
    update_cache: yes 
    name: pip
    state: latest

- name: install docker compose
  pip:
    name: docker-compose

- name: reboot
  reboot:
    reboot_timeout: 240
